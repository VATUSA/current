/*

jSignature v2
Copyright (c) 2012 Willow Systems Corp http://willow-systems.com
Copyright (c) 2010 Brinley Ang http://www.unbolt.net
MIT License <http://www.opensource.org/licenses/mit-license.php>


jSignature v2 jSignature's Undo Button and undo functionality plugin
Copyright (c) 2011 Willow Systems Corp http://willow-systems.com
MIT License <http://www.opensource.org/licenses/mit-license.php>


jSignature v2 jSignature's Sign Here "sticker" plugin
Copyright (c) 2011 Willow Systems Corp http://willow-systems.com
MIT License <http://www.opensource.org/licenses/mit-license.php>


jSignature v2 jSignature's custom "base30" format export and import plugins.
Copyright (c) 2011 Willow Systems Corp http://willow-systems.com
MIT License <http://www.opensource.org/licenses/mit-license.php>


Simplify.js BSD
(c) 2012, Vladimir Agafonkin
mourner.github.com/simplify-js


base64 encoder
MIT, GPL
http://phpjs.org/functions/base64_encode
+   original by: Tyler Akins (http://rumkin.com)
+   improved by: Bayron Guevara
+   improved by: Thunder.m
+   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+   bugfixed by: Pellentesque Malesuada
+   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+   improved by: Rafal Kukawski (http://kukawski.pl)


jSignature v2 SVG export plugin.
Copyright (c) 2012 Willow Systems Corp http://willow-systems.com
MIT License <http://www.opensource.org/licenses/mit-license.php>

*/
(function(){function q(a){for(var g,n=a.css("color"),x,a=a[0],c=!1;a&&!x&&!c;){try{g=$(a).css("background-color")}catch(h){g="transparent"}"transparent"!==g&&"rgba(0, 0, 0, 0)"!==g&&(x=g);c=a.body;a=a.parentNode}var a=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,c=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/,b;g=void 0;(g=n.match(a))?b={r:parseInt(g[1],10),g:parseInt(g[2],10),b:parseInt(g[3],10)}:(g=n.match(c))&&(b={r:parseInt(g[1],16),g:parseInt(g[2],16),b:parseInt(g[3],16)});var d;x?
  (g=void 0,(g=x.match(a))?d={r:parseInt(g[1],10),g:parseInt(g[2],10),b:parseInt(g[3],10)}:(g=x.match(c))&&(d={r:parseInt(g[1],16),g:parseInt(g[2],16),b:parseInt(g[3],16)})):d=b?127<Math.max.apply(null,[b.r,b.g,b.b])?{r:0,g:0,b:0}:{r:255,g:255,b:255}:{r:255,g:255,b:255};g=function(a){return"rgb("+[a.r,a.g,a.b].join(", ")+")"};b&&d?(a=Math.max.apply(null,[b.r,b.g,b.b]),b=Math.max.apply(null,[d.r,d.g,d.b]),b=Math.round(b+-0.75*(b-a)),b={r:b,g:b,b:b}):b?(b=Math.max.apply(null,[b.r,b.g,b.b]),a=1,127<b&&
(a=-1),b=Math.round(b+96*a),b={r:b,g:b,b:b}):b={r:191,g:191,b:191};return{color:n,"background-color":d?g(d):x,"decor-color":g(b)}}function o(a,g){this.x=a;this.y=g;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var n=function(a){return Math.round(a/Math.abs(a))};this.resizeTo=function(a){if(0===this.x&&0===this.y)this._length=0;else if(0===
  this.x)this._length=a,this.y=a*n(this.y);else if(0===this.y)this._length=a,this.x=a*n(this.x);else{var g=Math.abs(this.y/this.x),b=Math.sqrt(Math.pow(a,2)/(1+Math.pow(g,2))),g=g*b;this._length=a;this.x=b*n(this.x);this.y=g*n(this.y)}return this};this.angleTo=function(a){var g=this.getLength()*a.getLength();return 0===g?0:Math.acos(Math.min(Math.max((this.x*a.x+this.y*a.y)/g,-1),1))/Math.PI}}function f(a,g){this.x=a;this.y=g;this.getVectorToCoordinates=function(a,g){return new o(a-this.x,g-this.y)};
  this.getVectorFromCoordinates=function(a,g){return this.getVectorToCoordinates(a,g).reverse()};this.getVectorToPoint=function(a){return new o(a.x-this.x,a.y-this.y)};this.getVectorFromPoint=function(a){return this.getVectorToPoint(a).reverse()}}function r(a,g,b,c,h){this.data=a;this.context=g;if(a.length)for(var d=a.length,j,i,f=0;f<d;f++){j=a[f];i=j.x.length;b.call(g,j);for(var e=1;e<i;e++)c.call(g,j,e);h.call(g,j)}this.changed=function(){};this.startStrokeFn=b;this.addToStrokeFn=c;this.endStrokeFn=
  h;this.inStroke=!1;this._stroke=this._lastPoint=null;this.startStroke=function(a){if(a&&"number"==typeof a.x&&"number"==typeof a.y){this._stroke={x:[a.x],y:[a.y]};this.data.push(this._stroke);this._lastPoint=a;this.inStroke=!0;var g=this._stroke,b=this.startStrokeFn,n=this.context;setTimeout(function(){b.call(n,g)},3);return a}return null};this.addToStroke=function(a){if(this.inStroke&&"number"===typeof a.x&&"number"===typeof a.y&&4<Math.abs(a.x-this._lastPoint.x)+Math.abs(a.y-this._lastPoint.y)){var g=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              this._stroke.x.length;this._stroke.x.push(a.x);this._stroke.y.push(a.y);this._lastPoint=a;var b=this._stroke,n=this.addToStrokeFn,c=this.context;setTimeout(function(){n.call(c,b,g)},3);return a}return null};this.endStroke=function(){var a=this.inStroke;this.inStroke=!1;this._lastPoint=null;if(a){var g=this._stroke,b=this.endStrokeFn,n=this.context,c=this.changed;setTimeout(function(){b.call(n,g);c.call(n)},3);return!0}return null}}function s(a,g,b){var c=this.$parent=$(a),a=this.eventTokens={};this.events=
  new t(this);var h=$.fn[e]("globalEvents"),d={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10,showUndoButton:!1,data:[]};$.extend(d,q(c));g&&$.extend(d,g);this.settings=d;for(var j in b)b.hasOwnProperty(j)&&b[j].call(this,j);this.events.publish(e+".initializing");this.$controlbarUpper=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1em !important;margin-bottom:1em !important;"></div>').appendTo(c);
  this.isCanvasEmulator=!1;b=this.canvas=this.initializeCanvas(d);g=$(b);this.$controlbarLower=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1.5em !important;margin-bottom:1.5em !important;"></div>').appendTo(c);this.canvasContext=b.getContext("2d");g.data(e+".this",this);c=(c=d.lineWidth)?c:Math.max(Math.round(b.width/400),2);d.lineWidth=c;this.lineCurveThreshold=3*d.lineWidth;d.cssclass&&""!=$.trim(d.cssclass)&&g.addClass(d.cssclass);
  this.fatFingerCompensation=0;var c=function(a){var g,b,c=function(c){c=c.changedTouches&&0<c.changedTouches.length?c.changedTouches[0]:c;return new f(Math.round(c.pageX+g),Math.round(c.pageY+b)+a.fatFingerCompensation)},n=new y(750,function(){a.dataEngine.endStroke()});this.drawEndHandler=function(g){try{g.preventDefault()}catch(b){}n.clear();a.dataEngine.endStroke()};this.drawStartHandler=function(d){d.preventDefault();var h=$(a.canvas).offset();g=-1*h.left;b=-1*h.top;a.dataEngine.startStroke(c(d));
    n.kick()};this.drawMoveHandler=function(g){g.preventDefault();a.dataEngine.inStroke&&(a.dataEngine.addToStroke(c(g)),n.kick())};return this}.call({},this),i=c.drawEndHandler,k=c.drawStartHandler,m=c.drawMoveHandler,l=this.canvas,g=$(l);this.isCanvasEmulator?(g.bind("mousemove."+e,m),g.bind("mouseup."+e,i),g.bind("mousedown."+e,k)):(l.ontouchstart=function(a){l.onmousedown=void 0;l.onmouseup=void 0;l.onmousemove=void 0;this.fatFingerCompensation=d.minFatFingerCompensation&&-3*d.lineWidth>d.minFatFingerCompensation?
    -3*d.lineWidth:d.minFatFingerCompensation;k(a);l.ontouchend=i;l.ontouchstart=k;l.ontouchmove=m},l.onmousedown=function(a){l.ontouchstart=void 0;l.ontouchend=void 0;l.ontouchmove=void 0;k(a);l.onmousedown=k;l.onmouseup=i;l.onmousemove=m});a[e+".windowmouseup"]=h.subscribe(e+".windowmouseup",c.drawEndHandler);this.events.publish(e+".attachingEventHandlers");var p=this,a=d.width.toString(10),v=e;if("ratio"===a||"%"===a.split("")[a.length-1])this.eventTokens[v+".parentresized"]=h.subscribe(v+".parentresized",
    function(a,g,b){return function(){var c=g.width();if(c!==b){for(var n in a)if(a.hasOwnProperty(n)){h.unsubscribe(a[n]);delete a[n]}var d=p.settings;p.$parent.children().remove();for(n in p)p.hasOwnProperty(n)&&delete p[n];n=d.data;var c=c*1/b,x=[],j,i,f,e,k,l;i=0;for(f=n.length;i<f;i++){l=n[i];j={x:[],y:[]};e=0;for(k=l.x.length;e<k;e++){j.x.push(l.x[e]*c);j.y.push(l.y[e]*c)}x.push(j)}d.data=x;g[v](d)}}}(this.eventTokens,this.$parent,this.$parent.width(),1*this.canvas.width/this.canvas.height));this.resetCanvas(d.data);
  this.events.publish(e+".initialized");return this}var e="jSignature",y=function(a,g){var b;this.kick=function(){clearTimeout(b);b=setTimeout(g,a)};this.clear=function(){clearTimeout(b)};return this},t=function(a){this.topics={};this.context=a?a:this;this.publish=function(a,b,c,d){if(this.topics[a]){var h=this.topics[a],j=Array.prototype.slice.call(arguments,1),i=[],f,e,k,l;e=0;for(k=h.length;e<k;e++)l=h[e],f=l[0],l[1]&&(l[0]=function(){},i.push(e)),f.apply(this.context,j);e=0;for(k=i.length;e<k;e++)h.splice(i[e],
  1)}};this.subscribe=function(a,b,c){this.topics[a]?this.topics[a].push([b,c]):this.topics[a]=[[b,c]];return{topic:a,callback:b}};this.unsubscribe=function(a){if(this.topics[a.topic])for(var b=this.topics[a.topic],c=0,d=b.length;c<d;c++)b[c][0]===a.callback&&b.splice(c,1)}},z=function(a){var g=this.canvasContext,b=a.x[0],a=a.y[0],c=this.settings.lineWidth,d=g.fillStyle;g.fillStyle=g.strokeStyle;g.fillRect(b+c/-2,a+c/-2,c,c);g.fillStyle=d},u=function(a,g){var b=new f(a.x[g-1],a.y[g-1]),c=new f(a.x[g],
  a.y[g]),d=b.getVectorToPoint(c);if(1<g){var h=new f(a.x[g-2],a.y[g-2]),j=h.getVectorToPoint(b),i;if(j.getLength()>this.lineCurveThreshold){i=2<g?(new f(a.x[g-3],a.y[g-3])).getVectorToPoint(h):new o(0,0);var e=0.35*j.getLength(),k=j.angleTo(i.reverse()),l=d.angleTo(j.reverse());i=(new o(i.x+j.x,i.y+j.y)).resizeTo(Math.max(0.05,k)*e);var m=(new o(j.x+d.x,j.y+d.y)).reverse().resizeTo(Math.max(0.05,l)*e),j=this.canvasContext,e=h.x,l=h.y,k=b.x,p=b.y,v=h.x+i.x,h=h.y+i.y;i=b.x+m.x;m=b.y+m.y;j.beginPath();
  j.moveTo(e,l);j.bezierCurveTo(v,h,i,m,k,p);j.stroke()}}d.getLength()<=this.lineCurveThreshold&&(d=this.canvasContext,h=b.x,b=b.y,i=c.x,c=c.y,d.beginPath(),d.moveTo(h,b),d.lineTo(i,c),d.stroke())},w=function(a){var b=a.x.length-1;if(0<b){var c=new f(a.x[b],a.y[b]),d=new f(a.x[b-1],a.y[b-1]),h=d.getVectorToPoint(c);if(h.getLength()>this.lineCurveThreshold){if(1<b){var a=(new f(a.x[b-2],a.y[b-2])).getVectorToPoint(d),j=(new o(a.x+h.x,a.y+h.y)).resizeTo(h.getLength()/2),h=this.canvasContext,a=d.x,b=d.y,
                                                                                                                                                                                                                                                                                                                                                                                   i=c.x,e=c.y,k=d.x+j.x,d=d.y+j.y,j=c.x,c=c.y;h.beginPath();h.moveTo(a,b);h.bezierCurveTo(k,d,j,c,i,e)}else h=this.canvasContext,a=d.x,d=d.y,b=c.x,c=c.y,h.beginPath(),h.moveTo(a,d),h.lineTo(b,c);h.stroke()}}};s.prototype.resetCanvas=function(a){var b=this.canvas,c=this.settings,d=this.canvasContext,h=this.isCanvasEmulator,j=b.width,i=b.height;d.clearRect(0,0,j+30,i+30);d.shadowColor=d.fillStyle=c["background-color"];h&&d.fillRect(0,0,j+30,i+30);d.lineWidth=Math.ceil(parseInt(c.lineWidth,10));d.lineCap=
  d.lineJoin="round";d.strokeStyle=c["decor-color"];d.shadowOffsetX=0;d.shadowOffsetY=0;var k=Math.round(i/5),f=1.5*k,l=i-k,j=j-1.5*k,i=i-k;d.beginPath();d.moveTo(f,l);d.lineTo(j,i);d.stroke();d.strokeStyle=c.color;h||(d.shadowColor=d.strokeStyle,d.shadowOffsetX=0.5*d.lineWidth,d.shadowOffsetY=-0.6*d.lineWidth,d.shadowBlur=0);a||(a=[]);d=this.dataEngine=new r(a,this,z,u,w);c.data=a;$(b).data(e+".data",a).data(e+".settings",c);var m=this.$parent,p=this.events,v=e;d.changed=function(){p.publish(v+".change");
  m.trigger("change")};d.changed();return!0};s.prototype.initializeCanvas=function(a){var b=document.createElement("canvas"),c=$(b);a.width===a.height&&"ratio"===a.height&&(a.width="100%");c.css("margin",0).css("padding",0).css("border","none").css("height","ratio"===a.height||!a.height?1:a.height.toString(10)).css("width","ratio"===a.width||!a.width?1:a.width.toString(10));c.appendTo(this.$parent);"ratio"===a.height?c.css("height",Math.round(c.width()/a.sizeRatio)):"ratio"===a.width&&c.css("width",
  Math.round(c.height()*a.sizeRatio));c.addClass(e);b.width=c.width();b.height=c.height();a=b;if(a.getContext)a=!1;else if("undefined"!==typeof FlashCanvas)a=FlashCanvas.initElement(a),c=1,window&&(window.screen&&window.screen.deviceXDPI&&window.screen.logicalXDPI)&&(c=1*window.screen.deviceXDPI/window.screen.logicalXDPI),1!==c&&($(a).children("object").get(0).resize(Math.ceil(a.width*c),Math.ceil(a.height*c)),a.getContext("2d").scale(c,c)),a=!0;else throw Error("Canvas element does not support 2d context. jSignature cannot proceed.");
  this.isCanvasEmulator=a;b.onselectstart=function(a){a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation();return false};return b};var k=function(a,c){var b=new Image,d=this;b.onload=function(){d.getContext("2d").drawImage(b,0,0,b.width<d.width?b.width:d.width,b.height<d.height?b.height:d.height)};b.src="data:"+c+","+a},p=function(a){this.find("canvas."+e).add(this.filter("canvas."+e)).data(e+".this").resetCanvas(a);return this},b=function(a,b){if(void 0===b&&("string"===
  typeof a&&"data:"===a.substr(0,5))&&(b=a.slice(5).split(",")[0],a=a.slice(6+b.length),b===a))return;var c=this.find("canvas."+e).add(this.filter("canvas."+e));if(v.hasOwnProperty(b))0!==c.length&&v[b].call(c[0],a,b,function(a){return function(){return a.resetCanvas.apply(a,arguments)}}(c.data(e+".this")));else throw Error(e+" is unable to find import plugin with for format '"+String(b)+"'");return this},d=new t,h=e,c,j=function(){d.publish(h+".parentresized")};$(window).bind("resize."+h,function(){c&&
clearTimeout(c);c=setTimeout(j,500)}).bind("mouseup."+h,function(a){d.publish(h+".windowmouseup",a)});var i={},l={"default":function(){return this.toDataURL()},"native":function(a){return a},image:function(){var a=this.toDataURL();if("string"===typeof a&&4<a.length&&"data:"===a.slice(0,5)&&-1!==a.indexOf(",")){var b=a.indexOf(",");return[a.slice(5,b),a.substr(b+1)]}return[]}},v={"native":function(a,b,c){c(a)},image:k,"image/png;base64":k,"image/jpeg;base64":k,"image/jpg;base64":k},m={"export":l,"import":v,
  instance:i},A={init:function(a){return this.each(function(){var b,c=!1;for(b=this.parentNode;b&&!c;)c=b.body,b=b.parentNode;!c||new s(this,a,i)})},getSettings:function(){return this.find("canvas."+e).add(this.filter("canvas."+e)).data(e+".this").settings},clear:p,reset:p,addPlugin:function(a,b,c){m.hasOwnProperty(a)&&(m[a][b]=c);return this},listPlugins:function(a){var b=[];if(m.hasOwnProperty(a)){var a=m[a],c;for(c in a)a.hasOwnProperty(c)&&b.push(c)}return b},getData:function(a){var b=this.find("canvas."+
    e).add(this.filter("canvas."+e));void 0===a&&(a="default");if(0!==b.length&&l.hasOwnProperty(a))return l[a].call(b.get(0),b.data(e+".data"))},importData:b,setData:b,globalEvents:function(){return d},events:function(){return this.find("canvas."+e).add(this.filter("canvas."+e)).data(e+".this").events}};$.fn[e]=function(a){if(!a||"object"===typeof a)return A.init.apply(this,arguments);if("string"===typeof a&&A[a])return A[a].apply(this,Array.prototype.slice.call(arguments,1));$.error("Method "+String(a)+
  " does not exist on jQuery."+e)}})();
(function(){$.fn.jSignature("addPlugin","instance","UndoButton",function(q){this.events.subscribe("jSignature.attachingEventHandlers",function(){if(this.settings[q]){var o=this.settings[q];"function"!==typeof o&&(o=function(){var e=$('<input type="button" value="Undo last stroke" style="position:absolute;display:none;margin:0 !important;top:auto" />').appendTo(this.$controlbarLower),f=e.width();e.css("left",Math.round((this.canvas.width-f)/2));f!==e.width()&&e.width(f);return e});var f=o.call(this),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         r=this;r.events.subscribe("jSignature.change",function(){r.dataEngine.data.length?f.show():f.hide()});var s=this,e=(this.events.topics.hasOwnProperty("jSignature.undo")?q:"jSignature")+".undo";f.bind("click",function(){s.events.publish(e)});s.events.subscribe(e,function(){var e=s.dataEngine.data;e.length&&(e.pop(),s.resetCanvas(e))})}})})})();
(function(){$.fn.jSignature("addPlugin","instance","SignHere",function(q){this.events.subscribe("jSignature.attachingEventHandlers",function(){var o=function(){var f=$('<img style="position:absolute !important; top: auto; min-width:90px !important; max-width:180px !important;width:10% !important;border:none !important;padding: 0 !important;margin:0 !important;box-shadow:0 0 0 !important;" />');try{return f[0].src="data:image/gif;base64,R0lGODlhtABJAOf/AAABAAACAAEEAAIFAQQHAgUIBAcJBQoJAAgLBwwLAAoMCA0MAA8OAwwPCxMQAA8RDRURABYSARITERMVBBQVExcXABgYAhYYFRkaBBwbABkaGB0cAR4dAhocGRsdGh8fBSIgAB0fHB4gHSAhHyQjBSckACIjISgmASQlIyooBSYnJSwpAC0qAC4rAS8rAikqKCssKjEuBTMvAC0uLDUwAjcyBS8xLzg0Bjs1ATIzMTw3Azk5BDQ2MzY3NTs7Bjw8Bzg5Nz49ADo7OUA/AkJABEJBBTw+O0RCBj5APUVECEdFAUFCQElGAkpIBERGQ0xKBk5LB09MCEdJRlJOAlNPA0pLSVRQBFZSBk1PTFdTB1hUCVtVAE9RTlxXAl5YBFJUUVRVU2BaBmFbCFZXVWJcCVZYVVlbWWZgAmhhBGliBVxeW15gXWxlCW1mC2BiX25nDHBoAXJqA2NlYnRrBmZnZXFuCGhpZ3NwCnRxDHVyAHdzAWxta3l1A3p2BW9xbnx4CX55DIB7AHN1coJ8AYN+A3Z4dXh6d4eBCYiCDImDDnt9eoyFAI2GAo6HA36AfZCJBoCCf4KEgZOLDJWND4WHhJiQAYiKh5qSBZ2UCouNip+VDqGXAI6QjaSaA5CSj6ecB5SWk6ieC6qfDq2hAJeZlq+jAJmbmLCkAqynBJyem66oCZ2fnLCqDaCin7StALKsEKOloriwA7qyCaeppry0DamrqL+2AL21EMG4AKyuq8O6Aq6wrca8CbCyr7O1ssm/EcvBAM3DALa4tc/EAri6t7q8udLHCdPIDr2/vNXKEtjMANrNAMDCvtvPAsLEwd3QB8PFwsXHxN/SDcfJxuHUEuTWAOXXAOfYAMvNyejaBc3PzOrcC9DSz+zdEOjgE+viANPV0uzjAO3kAO7lANfZ1vDnBvLoC9nb2PPpD/brAPTqEtze2/ftAPnuAPrvAN/h3vvwAPzxBeHk4P7yCeXn5Ofp5unr6Ovt6u7w7fHz8PP18vX49Pn7+Pv9+v7//P///yH5BAEKAP8ALAAAAAC0AEkAAAj+AP8JHEhQoL+DCAsqXMiwocOHECNKnEixosWHCDNq9Hexo8ePIEOKhHiwXiQVFy6M+EKJ2L2NHEfKnEmz5sWDoAgE2MmT50pLxfDBtEm0qNGQBzntpGJLnLhqqgAxqdAzgIkxmZDlG3q0q9evBqHt1DSvrFmz1VD1URKhqgozmZht3Qi2rl2QB8EEGHS2r19qo/QcadtThRpO0OZqvMu4cUN/8ggs8Oa3cmVpovAQYVAVxhpP0fZxdUy6rr9ZAaxYXm053rJPdYIsqDrDDahpoumW3m3zoKAAiVgLXx1P2ac5O2bzJGBDDils/Ebznt7x4JIAt4ZrZ93u2KY3OJT+7ySQgw4pbdF1U19P0l+DAOK2yxfezpgmNjUM9DTQw04qbuktxt6ABPlDTgAnzKegdu0Ec0kaNOjEkwFA7NEKOAFmROB6/sASwBYLhrgdO8BUckYMEu5kgBB+XNiPdBvadZAfATQi4o3ysfPLJGK4UJUCRvgBCzkwxRSjVwcZEQAuODY5Hzq8SOIFC1U1gIQgs5xT5JFF+dOPAgGY4+SYCpqDSyNdnFDVA0sUUss6W3I5kj/gBMACmXiGWI4ti2hBQlUSOGFILu/EKedNrQQQBoOjeEHCCTggUk2eeYpDSyJXgFAVBVIosos8hh6KkT97BCDJcMrQUFUABPBV1ij+kuASDqVOhiMLIlRwUNUFVTjSCz2hilqgP0AEwItw3nAmwyeyGCPLGZzNKk5PJMARizq0OulNLINEsUFVHWABiS/1wHioP/wYQAC2rNURwAbs9IXOpGUhEl5PCzShSrZkbuPKIE1YAC4XkQhjj7kE+sNNADIM10UAOmz3RAAuELaAX7h4EYQYyfAb4jVRTVWVCCy5hDBv/qQSwBnDfbITFLzEw1o8beHSjix1kGUWOmhUlUV8HouYVh9JEOYTGEAJpV5pB9kRQCXaLUIYBnrQ61cwARgQr1/WUBkAEYPgsJMMMs8jjhixBB0iYHoQAUFVJpSRlWIaNnYQDwEEs13+OYhQtdOpfjESwA+VlePjAqiUFU8lEBhA2Tx/BBDBNWrjiNkdm7llBidynUwUugYY0M587GiSwk6b+MVEAH/41c7qBhx7VjfSmJXFTnNY1s4zlcvn2nGyVfXCYdDo4/mc2ARQQ4jtTBEAB6Ob1c5ssvilyU6fCFfDTgsA3RcgAYjS+4LtKNMJcuLt5BlouR3UJSkBsMFaNY1E3xc1O1Fz1jE7odOXOBNg3XDeph9EVMZ5YhgfjrrznXstpzbEcF9NDiKHAOjMMnkIQO78soydUM4sowgACfwSuQ+UbTXd+FsALLC1s2hhZasJRgWyp0AG2Qc/+mFVLiQ4k4PkIAD+xmDN9QjQCfvNgx3OO0JfBhEAKvjlT3yJxzV4MYpYKINdZZFFADAQjxhY0C8Tc1Vl4BAAPdSQfMHAA6t2wcM57UMyRnSdFXaygUFIAhF/+BYBZGeWK+ylL1gLQDW8UYJVVYAJ35jHIpo4D1QEIAUnLIuaLugXL7piNaJg0hktw0QC9KKNSJlGAHAwnHZ84garcoHezhKPAFbvLJUIwA7mUY309SSIL2TEPOLho0tKTydpq8y04GMZl4FoHrwAAR4GYUdVdOOMnfQFKD/iD1AEAA7yAUYf0JAFQMTCfq7AwRHmGABVeG8eTCRCWcTRjXCUgx3HKGBZ/qTJUzDMfs/+2EnHKqOKANBgNTsIAA3fsCoCMOET/hsf+AwgjGnexB9uCEAnxjSHVQVAmWXRgyxd9wM7jS6FASiH4nwEuHm8ImtxNIsa72CZcuzkcVF4JBSsEIRv7YQBzxxfH7IWQSN55CAzCIAyxsQOUSxiDle4gXIWMDpXBKACH1zn6rBTln6C4CwhXMAHGxGAG6yGCAFIXGW0iAGz+IiGZflFG2o2D2kwgQiJ2Ce/NGqAYjiUIge5ADFpFY9njOIXZVHHtzbQh1GoQg8YYFXqyrLTKbBSVVooSxoC8IbVtKV2lWHiFcryjZ1g9izt+GAbejKFofLrDllDxl0lkte9Vu4ZNu3+SQReWZYg/PEswNhJ9WyL1r5cg1W8CEYwjrEMb0RvdVBr5LuEY9smyGA8tPCLLS5xjWpYI6XyqagBVOvTihykA0JVoDk2oYQayOCgWJwHOoDpl9GWQB2c4R0/LbqTCaRAP8soCxkXxZpvMWkUbWGAac2iqZ58YA6rVFBFFcCM1Y6KDhrc5Gq0yIAWmkUcVAmD5FZDxgq4gAUpOMEG0rcBswagDso451nMsRNrlOUaqwPB445IX4qNYkEEVQA0HOwQOgVgAQmW8FmWEYHWVcZlO2nCaqgkvr6UQxoa5q8yqrIAEhBBDJOI3kktAFoqya8s0mDVNr6xDWBcAqwB+ED+iNgQAAVEg8cMOYgaJMdHIZvFwn45wk4mYZltvNQyvC2LyxaQ2FVpcrT8NYsjSyxoO/nlGo3Y14LiMdkGTAPOC0HXF3aCg0ocA7t29m0MIpBTv7jsn5Z5G2bPEIA2zKMd1aBiI+Zwh6396cZnwdrFJNtqSsWD1Q3ABqYVgi5H6JV7OoBDJ5QBajujQ6SWYbUZK5NCppaFyazJpwGgXRZ0xPROkgwArvMUDzEE4AHC7i5r0VULN8wgRT/2wRw+oYxIhno1p7OFZXBBsbK0QyefrYwkdlKDJkxBC10IoEBfvJNS56kdXgiABLQx7IJoZB/R8MQaYEDlINThE8+w973+y4IHKoD6elkoizX6x5rbWdQCTZ4HVxFEBC/ooRKqCEaz5wNxiXOj4sTeiD6gwQk1vKAqDCACHkYR8JGvhomAKEtud43vAExBQgsYRDAi+TD6qnNM7diCz4H+mI3kgxmZMIMKqhKBI+hhFPpzul+OsQV6hYNVbfgFnsvCjp08IxheS0Mcv7UIo87BCjhIrGPJ1I4XUgAcZG+PRvCBDEuMwQRsV0IfUGE1uZ+F1eNJgRYG8YnoGQOlR3TXh+wXZteaReRNasccLwB5dcsEJvggBiW+IIKqHBIQqoiq3F+xBaP9rdGoLgsTI9xocFeuHVQIwAWIZPsJbuQewqAEFzz+UBULNAEQr9iG3OszikFsQQmmdVkd+hLxALwyEQFQ8vjaEVMNaKn6XdpIPXwBCSyAtycbAAWDEAsO53m8kFB3ZlslUBYVlUAK1A4T0wH35xgwQQ+94AhVcGw8sQFTQAixkEie5xfhQARpkFEBwAQz1jvs0AQB0AFwgn9gUSTykAuKIAUSUBUgYAWIIAsqFoLzcAsqQgRwoAm/kIL8wg6rEwKFAoN3USTvkAuG4AQ32BMgkAWLcAs9OHKvoCZVwQI7R1RJEAAisIQbUiTrUAuFsATv0RMlsAWMgAvcNnLPIAlioANtEQFiojbqoGcjACpMiDIwcQ6zIAhIACY9kQL+XRAreeh03rCIaoMOYGUCfigs/1Ak5AALfmAEhsgTLOAFknCAPsgv1bAIPhIAKFAuf1iGG9EP4NAKewAEOcQTLoBlv5BeoRgi3TAJAbUTDeAGxBAglBhnG8EP3LAKdtADscgqMXAGlQAMe3eLliEOmqBnKlIGu9A+qRiMlTiM2mAKdJAD8EYANJAGl6Bz0NgX5vAJTyAhBIAFs0A32vhTw4gNpCAHNgBvBlADbKAJxvCFm8QOqqAF4uEEq6A0kRePPbYR+zANoOBuVIYDbbAJn2Zn7RALYsAZO2EEoICKB4mQeKWQGWd0VJZsy+aPYxIPuMAGRpMDmeCHHemR1GS+ds5QdGuHL/JGb7DXJMBQB7H1ApBwfy8Jkz1kdsiQCWWAAh33cSGHI8fwB3+yEyZgCD9XN0LJHrhXDJYABpjXE0m3dE3HGtIwCKXYgn5waVRZlVwCE/ege7zHdm4Hd5UBaduzExJAB8jwIgmBlggJE/YgDJHABf/HExGgeaigDJVgW7yoBsKQIXrZmNuoEfvnCFigARZlAGCQC9jomJppcRshD72gCFXQAVUAC/C4maaZaUWSl6e5mgkZlBYREAA7",
  f}catch(e){return $()}};this.settings[q]&&"function"===typeof this.settings[q].renderer&&(o=this.settings[q].renderer);var f=o();if(f.length){f.appendTo(this.$controlbarUpper);var r=this;f.bind("click",function(){f.hide()});r.events.subscribe("jSignature.change",function(){r.dataEngine.data.length?f.hide():f.show()})}})})})();
(function(){for(var q={},o={},f="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX".split(""),r=f.length/2,s=r-1;-1<s;s--)q[f[s]]=f[s+r],o[f[s+r]]=f[s];var e=function(e){for(var e=e.split(""),f=e.length,b=1;b<f;b++)e[b]=q[e[b]];return e.join("")},y=function(f){for(var p=[],b=0,d=1,h=f.length,c,j,i=0;i<h;i++)c=Math.round(f[i]),j=c-b,b=c,0>j&&0<d?(d=-1,p.push("Z")):0<j&&0>d&&(d=1,p.push("Y")),c=Math.abs(j),c>=r?p.push(e(c.toString(r))):p.push(c.toString(r));return p.join("")},t=function(e){for(var f=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [],e=e.split(""),b=e.length,d,h=1,c=[],j=0,i=0;i<b;i++)(d=e[i],d in q||"Z"===d||"Y"===d)?(0!==c.length&&(c=parseInt(c.join(""),r)*h+j,f.push(c),j=c),"Z"===d)?(h=-1,c=[]):"Y"===d?(h=1,c=[]):c=[d]:c.push(o[d]);f.push(parseInt(c.join(""),r)*h+j);return f},z=function(e){for(var f=[],b=e.length,d,h=0;h<b;h++)d=e[h],f.push(y(d.x)),f.push(y(d.y));return f.join("_")},u=function(e){for(var f=[],e=e.split("_"),b=e.length/2,d=0;d<b;d++)f.push({x:t(e[2*d]),y:t(e[2*d+1])});return f},f=function(e){return["image/jsignature;base30",
  z(e)]},s=function(e,f,b){"string"===typeof e&&("image/jsignature;base30"===e.substring(0,23).toLowerCase()&&(e=e.substring(24)),b(u(e)))};if(null==this.jQuery)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");var w=this.jQuery.fn.jSignature;w("addPlugin","export","base30",f);w("addPlugin","export","image/jsignature;base30",f);w("addPlugin","import","base30",s);w("addPlugin","import","image/jsignature;base30",s);this.jSignatureDebug&&(this.jSignatureDebug.base30=
  {remapTailChars:e,compressstrokeleg:y,uncompressstrokeleg:t,compressstrokes:z,uncompressstrokes:u,charmap:q})}).call("undefined"!==typeof window?window:this);
(function(){function q(b,d){this.x=b;this.y=d;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var h=function(b){return Math.round(b/Math.abs(b))};this.resizeTo=function(b){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=b,this.y=b*h(this.y);else if(0===this.y)this._length=b,this.x=b*h(this.x);else{var d=Math.abs(this.y/
  this.x),e=Math.sqrt(Math.pow(b,2)/(1+Math.pow(d,2))),d=d*e;this._length=b;this.x=e*h(this.x);this.y=d*h(this.y)}return this};this.angleTo=function(b){var d=this.getLength()*b.getLength();return 0===d?0:Math.acos(Math.min(Math.max((this.x*b.x+this.y*b.y)/d,-1),1))/Math.PI}}function o(b,d){this.x=b;this.y=d;this.getVectorToCoordinates=function(b,c){return new q(b-this.x,c-this.y)};this.getVectorFromCoordinates=function(b,c){return this.getVectorToCoordinates(b,c).reverse()};this.getVectorToPoint=function(b){return new q(b.x-
  this.x,b.y-this.y)};this.getVectorFromPoint=function(b){return this.getVectorToPoint(b).reverse()}}function f(b,d){var h=Math.pow(10,d);return Math.round(b*h)/h}function r(b,d,h){var d=d+1,c=new o(b.x[d-1],b.y[d-1]),e=new o(b.x[d],b.y[d]),e=c.getVectorToPoint(e),i=new o(b.x[d-2],b.y[d-2]),c=i.getVectorToPoint(c);return c.getLength()>h?(h=2<d?(new o(b.x[d-3],b.y[d-3])).getVectorToPoint(i):new q(0,0),b=0.35*c.getLength(),i=c.angleTo(h.reverse()),d=e.angleTo(c.reverse()),h=(new q(h.x+c.x,h.y+c.y)).resizeTo(Math.max(0.05,
  i)*b),e=(new q(c.x+e.x,c.y+e.y)).reverse().resizeTo(Math.max(0.05,d)*b),e=new q(c.x+e.x,c.y+e.y),["c",f(h.x,2),f(h.y,2),f(e.x,2),f(e.y,2),f(c.x,2),f(c.y,2)]):["l",f(c.x,2),f(c.y,2)]}function s(b,d){var e=b.x.length-1,c=new o(b.x[e],b.y[e]),j=new o(b.x[e-1],b.y[e-1]),c=j.getVectorToPoint(c);if(1<e&&c.getLength()>d){var e=(new o(b.x[e-2],b.y[e-2])).getVectorToPoint(j),j=c.angleTo(e.reverse()),i=0.35*c.getLength(),e=(new q(e.x+c.x,e.y+c.y)).resizeTo(Math.max(0.05,j)*i);return["c",f(e.x,2),f(e.y,2),f(c.x,
  2),f(c.y,2),f(c.x,2),f(c.y,2)]}return["l",f(c.x,2),f(c.y,2)]}function e(b,d,e){for(var d=["M",f(b.x[0]-d,2),f(b.y[0]-e,2)],e=1,c=b.x.length-1;e<c;e++)d.push.apply(d,r(b,e,1));0<c?d.push.apply(d,s(b,e,1)):0===c&&d.push.apply(d,["l",1,1]);return d.join(" ")}function y(b){var d=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'],h,c=b.length,j,i=[],f=[],v=j=h=0,m=0,k=[];if(0!==c){for(h=0;h<c;h++){v=
  b[h];m=[];j={x:[],y:[]};for(var a=void 0,g=void 0,a=0,g=v.x.length;a<g;a++)m.push({x:v.x[a],y:v.y[a]});m=simplify(m,0.7,!0);a=0;for(g=m.length;a<g;a++)j.x.push(m[a].x),j.y.push(m[a].y);k.push(j);i=i.concat(j.x);f=f.concat(j.y)}b=Math.min.apply(null,i)-1;c=Math.max.apply(null,i)+1;i=Math.min.apply(null,f)-1;f=Math.max.apply(null,f)+1;v=0>b?0:b;m=0>i?0:i;h=c-b;j=f-i}d.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+h.toString()+'" height="'+j.toString()+'">');h=0;for(c=k.length;h<
c;h++)j=k[h],d.push('<path fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="'+e(j,v,m)+'"/>');d.push("</svg>");return d.join("")}function t(b){return[k,y(b)]}function z(b){return[p,w(y(b))]}var u=window;"use strict";("undefined"!=typeof exports?exports:u).simplify=function(b,d,e){d=void 0!==d?d*d:1;if(!e){for(var c=b.length,f,i=b[0],l=[i],e=1;e<c;e++){f=b[e];var k=f.x-i.x,m=f.y-i.y;k*k+m*m>d&&(l.push(f),i=f)}b=(i!==f&&l.push(f),l)}f=b;var e=f.length,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          c=new ("undefined"!=typeof Uint8Array?Uint8Array:Array)(e),i=0,l=e-1,o,a,g=[],n=[],q=[];for(c[i]=c[l]=1;l;){m=0;for(k=i+1;k<l;k++){o=f[k];var p=f[i],s=f[l],r=p.x,u=p.y,p=s.x-r,t=s.y-u,w=void 0;if(0!==p||0!==t)w=((o.x-r)*p+(o.y-u)*t)/(p*p+t*t),1<w?(r=s.x,u=s.y):0<w&&(r+=p*w,u+=t*w);o=(p=o.x-r,t=o.y-u,p*p+t*t);o>m&&(a=k,m=o)}m>d&&(c[a]=1,g.push(i),n.push(a),g.push(a),n.push(l));i=g.pop();l=n.pop()}for(k=0;k<e;k++)c[k]&&q.push(f[k]);return b=q,b};if("function"!==typeof w)var w=function(b){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         e,c,f,i,l=0,k=0,m="",m=[];do e=b.charCodeAt(l++),c=b.charCodeAt(l++),f=b.charCodeAt(l++),i=e<<16|c<<8|f,e=i>>18&63,c=i>>12&63,f=i>>6&63,i&=63,m[k++]=d[e]+d[c]+d[f]+d[i];while(l<b.length);m=m.join("");b=b.length%3;return(b?m.slice(0,b-3):m)+"===".slice(b||3)};var k="image/svg+xml",p="image/svg+xml;base64";if("undefined"===typeof $)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");u=$.fn.jSignature;u("addPlugin","export","svg",t);u("addPlugin",
  "export",k,t);u("addPlugin","export","svgbase64",z);u("addPlugin","export",p,z)})();